# Документация по провайдерам

Эта папка содержит документацию, связанную с функциональностью провайдеров услуг.

## Структура

```
docs/
├── diagrams/          # PlantUML диаграммы
│   ├── 1. PROVIDER_FORM_CREATION_SEQUENCE.puml
│   ├── 2. PROVIDER_FORM_APPROVAL.puml
│   ├── 3. PROVIDER_REQUISITES_FILLING.puml
│   ├── 4. PROVIDER_ACTIVATION.puml
│   ├── 5. PROVIDER_CONTRACT_CREATION.puml
│   ├── 6. PROVIDER_CONTRACT_APPROVAL.puml
│   ├── PROVIDER_ADMIN_ACCESS.puml
│   ├── PROVIDER_UI_DISPLAY_FLOW.puml
│   ├── PROVIDER_ACCESS_IMPLEMENTATION.puml
│   └── PROVIDER_ADMIN_ACCESS_AND_UI_FLOW.puml
└── README.md          # Этот файл
```

## Диаграммы

### 1. PROVIDER_FORM_CREATION_SEQUENCE.puml
Диаграмма последовательности создания заявки провайдера услуг. Показывает процесс от заполнения формы (включая выбор категорий услуг уровня 0) до сохранения в базе данных.

### 2. PROVIDER_FORM_APPROVAL.puml
Диаграмма последовательности одобрения заявки провайдера и назначения биллинг-менеджера системным администратором. Показывает процесс одобрения, создания Provider, установки категорий услуг, назначения ролей, назначения биллинг-менеджера и отправки писем.

### 3. PROVIDER_REQUISITES_FILLING.puml
Диаграмма последовательности заполнения реквизитов провайдера (ИНН, регистрационный номер) биллинг-менеджером. Показывает процесс заполнения реквизитов и автоматическую установку статуса `activation_required`.

### 4. PROVIDER_ACTIVATION.puml
Диаграмма последовательности активации провайдера системным администратором. Показывает процесс активации провайдера после заполнения реквизитов (перевод из `activation_required` в `active`). После активации админ провайдера может создавать точки и услуги, но не может создавать работников и расписания до заключения контракта.

### 5. PROVIDER_CONTRACT_CREATION.puml
Диаграмма последовательности создания контракта провайдера. Показывает процесс создания контракта биллинг-менеджером или админом провайдера, включая автоматическое наследование порогов блокировки и стандартных условий из типа контракта. Контракт создается со статусом `draft`.

### 6. PROVIDER_CONTRACT_APPROVAL.puml
Диаграмма последовательности одобрения контракта провайдера. Показывает процесс отправки контракта на согласование биллинг-менеджером (статус `draft` → `pending_approval`) и одобрения системным администратором (статус `pending_approval` → `active`). После одобрения контракта админ провайдера получает полные возможности (создание работников и расписаний), а услуги начинают отображаться на фронтенде.

### PROVIDER_ADMIN_ACCESS.puml
Диаграмма доступа администратора провайдера к моделям в Django Admin. Описывает права доступа к различным моделям в зависимости от статуса провайдера и наличия контракта.

### PROVIDER_UI_DISPLAY_FLOW.puml
Диаграмма логики отображения услуг провайдера на фронтенде. Показывает условия, при которых услуги провайдера отображаются конечным пользователям.

### PROVIDER_ACCESS_IMPLEMENTATION.puml
Детали реализации прав доступа для администратора провайдера. Описывает методы проверки прав, логику автозаполнения и проверки контрактов.

### PROVIDER_ADMIN_ACCESS_AND_UI_FLOW.puml
Объединенная диаграмма, включающая доступ администратора провайдера и логику отображения на UI.

## Как просматривать диаграммы

Диаграммы написаны в формате PlantUML. Для просмотра можно использовать:

1. **VS Code / Cursor**: Установите расширение "PlantUML"
2. **Онлайн**: http://www.plantuml.com/plantuml/uml/
3. **Локально**: Установите PlantUML и используйте команду `plantuml diagram.puml`

